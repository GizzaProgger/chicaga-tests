name: chicaga-test-on-schedule
on:
  schedule:
    # * is a special character in YAML so you have to quote this string
    - cron:  '0 23 * * *'

jobs:
  build:
    runs-on: windows-latest # or macos-latest, windows-latest
    steps:
      - uses: actions/checkout@v2
      - name: node
        uses: actions/setup-node@v1
        with:
          node-version: 16.x
      - name: 'npm:install'
        run: npm install
      - name: test
        run: npm test
      - uses: actions/upload-artifact@v2
        with:
          name: screenshots
          path: screens/

- name: Send mail
  if: always()
  uses: dawidd6/action-send-mail@v2
  with:
    # mail server settings
    server_address: smtp.gmail.com
    server_port: 465
    # user credentials
    username: ${{ secrets.EMAIL_USERNAME }}
    password: ${{ secrets.EMAIL_PASSWORD }}
    # email subject
    subject: Ошибка на сайте
    # email body as text
    body: ${{ github.job }} job in worflow ${{ github.workflow }} of ${{ github.repository }} has ${{ job.status }}
    # comma-separated string, send email to
    to: 147rawil147@gmail.com
    # from email name
    from: Chicaga tests